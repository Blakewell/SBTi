<style>
    .container {
        margin-top: 75px;
    }

    .container-results {
        margin-top: 25px;
        margin-bottom: 25px;
    }

    .table-results {
        margin-top: 10px;
    }
</style>

<!-- Toolbar -->
<nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top">
    <a class="navbar-brand" href="#">SBTi</a>
    <button class="navbar-toggler hidden-sm-up" type="button" (click)="isNavbarCollapsed = !isNavbarCollapsed"
        data-target="#navbarsDefault" aria-controls="navbarsDefault" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div [ngbCollapse]="isNavbarCollapsed" class="collapse navbar-collapse" id="navbarsDefault">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" id="nav-link-temperature-score" href="#">Temperature score</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="nav-link-portfolio-coverage" href="#">Portfolio coverage</a>
            </li>
        </ul>
    </div>
</nav>

<div class="container" role="main">
    <h2>SBTi Temperature Scoring</h2>
    <form>
        <div class="form-group">
            <label for="input-excel_file">Excel file</label>
            <input (change)="fileChange($event)" type="file" class="form-control-file" id="input-excel_file"
                name="input-excel_file" aria-describedby="input-excel_file">
        </div>
        <div class="form-group">
            <label for="input-excel_skiprows">Skip rows</label>
            <input type="number" class="form-control" id="input-excel_skiprows" name="input-excel_skiprows"
                [(ngModel)]="excelSkiprows">
        </div>
        <button class="btn btn-primary" (click)="parseExcel()">Parse Excel</button>
        <hr />
        <h6>Map your columns to input fields</h6>
        <div class="row" *ngIf="columns.length > 0">
            <div class="col">
                <p *ngFor="let column of columns">
                    <input class="form-control" value="{{column}}" disabled />
                </p>
            </div>
            <div class="col">
                <p *ngFor="let column of columns">
                    <select class="form-control" name="select-map_{{column}}" [(ngModel)]="columnMapping[column]">
                        <option></option>
                        <option *ngFor="let targetColumn of availableTargetColumns">{{targetColumn}}</option>
                    </select>
                </p>
            </div>
        </div>
    </form>
    <form (ngSubmit)="onSubmit(f)" #f="ngForm">
        <hr />
        <h6>API settings (leave empty to use the defaults)</h6>
        <!-- TODO: Add the default score -->
        <div class="form-group">
            <label for="input-defaultScore">Default temperature score</label>
            <input type="number" class="form-control" id="input-defaultScore" step="0.1" name="input-defaultScore"
                [(ngModel)]="defaultScore">
        </div>
        <div class="form-group">
            <label for="input-aggregationMethod">Aggregation method</label>
            <select class="form-control" [(ngModel)]="selectedAggregationMethod" name="aggregationMethod"
                class="form-control" id="input-aggregationMethod">
                <option *ngFor="let aggregationMethod of availableAggregationMethods">{{aggregationMethod}}</option>
            </select>
        </div>
        <div class="form-group">
            <label for="input-filterTimeFrames">Time frame</label>
            <select [(ngModel)]="filterTimeFrames" name="filterTimeFrames" multiple class="form-control"
                id="input-filterTimeFrames">
                <option *ngFor="let timeFrame of availableTimeFrames">{{timeFrame}}</option>
            </select>
        </div>
        <div class="form-group">
            <label for="input-filterScopeCategory">Scope</label>
            <select [(ngModel)]="filterScopeCategory" name="filterScopeCategory" multiple class="form-control"
                id="input-filterScopeCategory">
                <option *ngFor="let scopeCategory of availableScopeCategories">{{scopeCategory}}</option>
            </select>
        </div>
        <div class="form-group">
            <label for="input-dataProviders">Data provider(s)</label>
            <select class="form-control" id="input-dataProviders" name="dataProviders" [(ngModel)]="selectedDataProviders"
                multiple>
                <option *ngFor="let dataProvider of dataProviders">{{dataProvider.name}}</option>
            </select>
        </div>
        <div class="form-group">
            <label for="columns">Columns</label>
            <select class="form-control" id="columns" name="columns" [(ngModel)]="includeColumns" multiple>
                <option *ngFor="let availableColumn of availableColumns">{{availableColumn}}</option>
            </select>
        </div>

        <button class="btn btn-success">Get temperature score</button>
    </form>

    <div id="div-results" class="container-results" *ngIf="resultTargets.length > 0">
        <div class="row" *ngIf="'short' in resultScores">
            <div class="col">
                <div class="card text-center">
                    <div class="card-header">
                        Short term
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{resultScores["short"] | number:'1.2-2'}}&#176;C</h5>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card text-center">
                    <div class="card-header">
                        Mid term
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{resultScores["mid"] | number:'1.2-2'}}&#176;C</h5>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card text-center">
                    <div class="card-header">
                        Long term
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{resultScores["long"] | number:'1.2-2'}}&#176;C</h5>
                    </div>
                </div>
            </div>
        </div>

        <div class="container-results">
            <h5>Temperature score targets <button class="btn btn-outline-primary"
                    (click)="exportCSV()">Download</button></h5>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col" *ngFor="let resultColumn of resultColumns">{{resultColumn}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let target of resultTargets">
                        <td scope="row" *ngFor="let resultColumn of resultColumns">{{ target[resultColumn] }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>

<router-outlet></router-outlet>